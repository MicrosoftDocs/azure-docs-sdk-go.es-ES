---
title: Autenticación con el SDK de Azure para Go
description: Obtenga información sobre los métodos de autenticación disponibles en el SDK de Azure para Go y cómo utilizarlos.
services: azure
author: sptramer
ms.author: sttramer
manager: carmonm
ms.date: 09/05/2018
ms.topic: conceptual
ms.technology: azure-sdk-go
ms.devlang: go
ms.service: active-directory
ms.component: authentication
ms.openlocfilehash: 8f94b9ba715c32263d324306cce69bd484c05702
ms.sourcegitcommit: c435f6602524565d340aac5506be5e955e78f16c
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 09/12/2018
ms.locfileid: "44711981"
---
# <a name="authentication-methods-in-the-azure-sdk-for-go"></a><span data-ttu-id="4ffc2-103">Métodos de autenticación en el SDK de Azure para Go</span><span class="sxs-lookup"><span data-stu-id="4ffc2-103">Authentication methods in the Azure SDK for Go</span></span>

<span data-ttu-id="4ffc2-104">Azure SDK para Go ofrece varias maneras de autenticarse con Azure.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-104">The Azure SDK for Go offers multiple ways to authenticate with Azure.</span></span> <span data-ttu-id="4ffc2-105">Estos _tipos_ de autenticación se invocan con diferentes _métodos_ de autenticación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-105">These authentication _types_ are invoked through different authentication _methods_.</span></span> <span data-ttu-id="4ffc2-106">En este artículo se describen los tipos y métodos disponibles, y cómo elegir los más adecuados para su aplicación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-106">This article covers the available types, methods, and how to choose which are best for your application.</span></span>

## <a name="available-authentication-types-and-methods"></a><span data-ttu-id="4ffc2-107">Métodos y tipos de autenticación disponibles</span><span class="sxs-lookup"><span data-stu-id="4ffc2-107">Available authentication types and methods</span></span>

<span data-ttu-id="4ffc2-108">El SDK de Azure para Go ofrece varios tipos diferentes de autenticación, mediante el uso de diferentes conjuntos de credenciales.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-108">The Azure SDK for Go offers several different types of authentication, using different credentials sets.</span></span> <span data-ttu-id="4ffc2-109">Cada tipo de autenticación está disponible mediante diferentes métodos de autenticación, que explican cómo el SDK toma estas credenciales como datos de entrada.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-109">Each authentication type is available through different authentication methods, which are how the SDK takes these credentials as input.</span></span> <span data-ttu-id="4ffc2-110">En la siguiente tabla se describen los tipos de autenticación disponibles y las situaciones en las que la aplicación recomienda utilizarlos.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-110">The following table describes the available types of authentication and situations in which they're recommended for use by your application.</span></span>

| <span data-ttu-id="4ffc2-111">Tipo de autenticación</span><span class="sxs-lookup"><span data-stu-id="4ffc2-111">Authentication type</span></span> | <span data-ttu-id="4ffc2-112">Recomendado si...</span><span class="sxs-lookup"><span data-stu-id="4ffc2-112">Recommended when...</span></span> |
|---------------------|---------------------|
| <span data-ttu-id="4ffc2-113">Autenticación basada en certificados</span><span class="sxs-lookup"><span data-stu-id="4ffc2-113">Certificate-based authentication</span></span> | <span data-ttu-id="4ffc2-114">Tiene un certificado X509 configurado para un usuario o entidad de servicio de Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-114">You have an X509 certificate that was configured for an Azure Active Directory (AAD) user or service principal.</span></span> <span data-ttu-id="4ffc2-115">Para más información, consulte [Introducción a la autenticación basada en certificados de Azure Active Directory].</span><span class="sxs-lookup"><span data-stu-id="4ffc2-115">To learn more, see [Get started with certificate-based authentication in Azure Active Directory].</span></span> |
| <span data-ttu-id="4ffc2-116">Credenciales de cliente</span><span class="sxs-lookup"><span data-stu-id="4ffc2-116">Client credentials</span></span> | <span data-ttu-id="4ffc2-117">Tiene una entidad de servicio configurada que está preparada para esta aplicación o una clase de aplicaciones a las que pertenece.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-117">You have a configured service principal that is set up for this application or a class of applications it belongs to.</span></span> <span data-ttu-id="4ffc2-118">Para más información, consulte [Creación de una entidad de servicio con la CLI de Azure].</span><span class="sxs-lookup"><span data-stu-id="4ffc2-118">To learn more, see [Create a service principal with Azure CLI].</span></span> |
| <span data-ttu-id="4ffc2-119">Identidades administradas de recursos de Azure</span><span class="sxs-lookup"><span data-stu-id="4ffc2-119">Managed identities for Azure resources</span></span> | <span data-ttu-id="4ffc2-120">La aplicación se ejecuta en un recurso de Azure que se ha configurado con una identidad administrada.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-120">Your application is running on an Azure resource that has been configured with a managed identity.</span></span> <span data-ttu-id="4ffc2-121">Para más información, consulte [Identidades administradas para recursos de Azure].</span><span class="sxs-lookup"><span data-stu-id="4ffc2-121">To learn more, see [Managed identities for Azure resources].</span></span> |
| <span data-ttu-id="4ffc2-122">Token del dispositivo</span><span class="sxs-lookup"><span data-stu-id="4ffc2-122">Device token</span></span> | <span data-ttu-id="4ffc2-123">La aplicación está diseñada para usarse __solo__ interactivamente.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-123">Your application is meant to be used interactively __only__.</span></span> <span data-ttu-id="4ffc2-124">Los usuarios pueden tener habilitada la autenticación multifactor.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-124">Users may have multi-factor authentication enabled.</span></span> <span data-ttu-id="4ffc2-125">Los usuarios tienen acceso a un explorador web para iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-125">Users have access to a web browser to sign in.</span></span> <span data-ttu-id="4ffc2-126">Para más información, consulte [Use device token authentication](#use-device-token-authentication) (Uso de la autenticación por tokens del dispositivo).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-126">For more information, see [Use device token authentication](#use-device-token-authentication).</span></span>|
| <span data-ttu-id="4ffc2-127">Nombre de usuario/contraseña</span><span class="sxs-lookup"><span data-stu-id="4ffc2-127">Username/password</span></span> | <span data-ttu-id="4ffc2-128">Tiene una aplicación interactiva que no puede utilizar ningún otro método de autenticación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-128">You have an interactive application that can't use any other authentication method.</span></span> <span data-ttu-id="4ffc2-129">Los usuarios no tienen habilitada la autenticación multifactor para su inicio de sesión de AAD.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-129">Your users don't have multi-factor authentication enabled for their AAD sign-in.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="4ffc2-130">Si usa un tipo de autenticación diferente a las credenciales de cliente, la aplicación debe estar registrada en Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-130">If you use an authentication type other than client credentials, your application must be registered in Azure Active Directory.</span></span> <span data-ttu-id="4ffc2-131">Para más información, consulte [Integración de aplicaciones con Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-131">To learn how, see [Integrating applications with Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span></span>
>
> [!NOTE]
> <span data-ttu-id="4ffc2-132">A menos que tenga requisitos especiales, evite la autenticación por nombre de usuario o contraseña.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-132">Unless you have special requirements, avoid username/password authentication.</span></span> <span data-ttu-id="4ffc2-133">En situaciones en las que el inicio de sesión basado en usuario es apropiado, normalmente se puede utilizar la autenticación por tokens del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-133">In situations where user-based sign in is appropriate, device token authentication can usually be used instead.</span></span>

[Introducción a la autenticación basada en certificados de Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Get started with certificate-based authentication in Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Creación de una entidad de servicio con la CLI de Azure]: /cli/azure/create-an-azure-service-principal-azure-cli
[Create a service principal with Azure CLI]: /cli/azure/create-an-azure-service-principal-azure-cli
[Identidades administradas para recursos de Azure]: /azure/active-directory/managed-identities-azure-resources/overview
[Managed identities for Azure resources]: /azure/active-directory/managed-identities-azure-resources/overview

<span data-ttu-id="4ffc2-137">Estos tipos de autenticación están disponibles a través de diferentes métodos.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-137">These authentication types are available through different methods.</span></span>

* <span data-ttu-id="4ffc2-138">[_La autenticación basada en entornos_](#use-environment-based-authentication) lee las credenciales directamente desde el entorno del programa.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-138">[_Environment-based authentication_](#use-environment-based-authentication) reads credentials directly from the program's environment.</span></span>
* <span data-ttu-id="4ffc2-139">[_La autenticación basada en archivos_ ](#use-file-based-authentication) carga un archivo que contiene las credenciales de la entidad de servicio.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-139">[_File-based authentication_](#use-file-based-authentication) loads a file containing service principal credentials.</span></span>
* <span data-ttu-id="4ffc2-140">[_La autenticación basada en cliente_](#use-an-authentication-client) utiliza un objeto en el código y le hace responsable de proporcionar las credenciales durante la ejecución del programa.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-140">[_Client-based authentication_](#use-an-authentication-client) uses an object in code and makes you responsible for providing the credentials during program execution.</span></span>
* <span data-ttu-id="4ffc2-141">[_La autenticación de token de dispositivo_](#use-device-token-authentication) requiere que los usuarios inicien sesión interactivamente mediante un explorador web con un token.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-141">[_Device token authentication_](#use-device-token-authentication) requires users to sign in interactively through a web browser with a token.</span></span>

<span data-ttu-id="4ffc2-142">Todas las funciones y tipos de autenticación están disponibles en el paquete `github.com/Azure/go-autorest/autorest/azure/auth`.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-142">All authentication functions and types are available in the `github.com/Azure/go-autorest/autorest/azure/auth` package.</span></span>

> [!NOTE]
> <span data-ttu-id="4ffc2-143">A menos que tenga requisitos especiales, evite la autenticación basada en cliente.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-143">Unless you have special requirements, avoid client-based authentication.</span></span> <span data-ttu-id="4ffc2-144">Este método de autenticación fomenta las malas prácticas.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-144">This method of authentication encourages bad practices.</span></span> <span data-ttu-id="4ffc2-145">En particular, el uso de la autenticación basada en cliente hace que sea tentador codificar de forma rígida las credenciales.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-145">In particular, using client-based authentication makes it tempting to hard-code credentials.</span></span> <span data-ttu-id="4ffc2-146">La escritura de código personalizado para la autenticación también puede interrumpirse en futuras versiones del SDK si cambian los requisitos de autenticación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-146">Writing custom code for authentication may also break under future SDK releases if authentication requirements change.</span></span>

## <a name="use-environment-based-authentication"></a><span data-ttu-id="4ffc2-147">Uso de la autenticación basada en entornos</span><span class="sxs-lookup"><span data-stu-id="4ffc2-147">Use environment-based authentication</span></span>

<span data-ttu-id="4ffc2-148">Si ejecuta la aplicación en un entorno controlado, la autenticación basada en entornos es la opción natural.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-148">If you're running your application in a controlled setting, environment-based authentication is a natural choice.</span></span> <span data-ttu-id="4ffc2-149">Con este método de autenticación, el shell de entorno se configura antes de ejecutar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-149">With this authentication method, you configure the shell environment before running your application.</span></span> <span data-ttu-id="4ffc2-150">En tiempo de ejecución, el SDK para Go lee estas variables de entorno para autenticarse con Azure.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-150">At runtime, the Go SDK reads these environment variables to authenticate with Azure.</span></span>

<span data-ttu-id="4ffc2-151">La autenticación basada en entornos es compatible con todos los métodos de autenticación excepto con los tokens de dispositivo, que se evalúan en el siguiente orden:</span><span class="sxs-lookup"><span data-stu-id="4ffc2-151">Environment-based authentication has support for all authentication methods except device tokens, evaluated in the following order:</span></span>

* <span data-ttu-id="4ffc2-152">Credenciales de cliente</span><span class="sxs-lookup"><span data-stu-id="4ffc2-152">Client credentials</span></span>
* <span data-ttu-id="4ffc2-153">Certificados X509</span><span class="sxs-lookup"><span data-stu-id="4ffc2-153">X509 certificates</span></span>
* <span data-ttu-id="4ffc2-154">Nombre de usuario/contraseña</span><span class="sxs-lookup"><span data-stu-id="4ffc2-154">Username/password</span></span>
* <span data-ttu-id="4ffc2-155">Identidades administradas de recursos de Azure</span><span class="sxs-lookup"><span data-stu-id="4ffc2-155">Managed identities for Azure resources</span></span>

<span data-ttu-id="4ffc2-156">Si un tipo de autenticación tiene valores no establecidos o se rechaza, el SDK intenta automáticamente con el siguiente tipo de autenticación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-156">If an authentication type has unset values or is refused, the SDK automatically tries the next authentication type.</span></span> <span data-ttu-id="4ffc2-157">Cuando no hay más tipos disponibles para probar, el SDK de devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-157">When no more types are available to try, the SDK returns an error.</span></span>

<span data-ttu-id="4ffc2-158">En la tabla siguiente se detallan las variables de entorno que deben configurarse para cada tipo de autenticación admitida por la autenticación basada en entornos.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-158">The following table details the environment variables that need to be set for each authentication type supported by environment-based authentication.</span></span>

| <span data-ttu-id="4ffc2-159">Tipo de autenticación</span><span class="sxs-lookup"><span data-stu-id="4ffc2-159">Authentication type</span></span> | <span data-ttu-id="4ffc2-160">Variable de entorno</span><span class="sxs-lookup"><span data-stu-id="4ffc2-160">Environment variable</span></span> | <span data-ttu-id="4ffc2-161">DESCRIPCIÓN</span><span class="sxs-lookup"><span data-stu-id="4ffc2-161">Description</span></span> |
| ------------------- | -------------------- | ----------- |
| <span data-ttu-id="4ffc2-162">__Credenciales de cliente__</span><span class="sxs-lookup"><span data-stu-id="4ffc2-162">__Client credentials__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="4ffc2-163">El identificador del inquilino de Active Directory al que pertenece la entidad de servicio.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-163">The ID for the Active Directory tenant that the service principal belongs to.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="4ffc2-164">El nombre o identificador de la entidad de servicio.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-164">The name or ID of the service principal.</span></span> |
| | `AZURE_CLIENT_SECRET` | <span data-ttu-id="4ffc2-165">Secreto asociado a la entidad de servicio.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-165">The secret associated with the service principal.</span></span> |
| <span data-ttu-id="4ffc2-166">__Certificate__</span><span class="sxs-lookup"><span data-stu-id="4ffc2-166">__Certificate__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="4ffc2-167">El identificador del inquilino de Active Directory con el que está registrado el certificado.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-167">The ID for the Active Directory tenant that the certificate is registered with.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="4ffc2-168">El identificador del cliente de aplicación asociado al certificado.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-168">The application client ID associated with the certificate.</span></span> |
| | `AZURE_CERTIFICATE_PATH` | <span data-ttu-id="4ffc2-169">La ruta de acceso a un archivo de certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-169">The path to the client certificate file.</span></span> |
| | `AZURE_CERTIFICATE_PASSWORD` | <span data-ttu-id="4ffc2-170">La contraseña para el certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-170">The password for the client certificate.</span></span> |
| <span data-ttu-id="4ffc2-171">__Nombre de usuario/contraseña__</span><span class="sxs-lookup"><span data-stu-id="4ffc2-171">__Username/Password__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="4ffc2-172">El identificador del inquilino de Active Directory al que pertenece el usuario.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-172">The ID for the Active Directory tenant that the user belongs to.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="4ffc2-173">El identificador del cliente de aplicación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-173">The application client ID.</span></span> |
| | `AZURE_USERNAME` | <span data-ttu-id="4ffc2-174">El nombre de usuario con el que se va a iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-174">The username to sign in with.</span></span> |
| | `AZURE_PASSWORD` | <span data-ttu-id="4ffc2-175">La contraseña con la que se va a iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-175">The password to sign in with.</span></span> |
| <span data-ttu-id="4ffc2-176">__Identidad administrada__</span><span class="sxs-lookup"><span data-stu-id="4ffc2-176">__Managed identity__</span></span> | | <span data-ttu-id="4ffc2-177">No se requieren credenciales para la autenticación con identidades administradas.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-177">No credentials are needed for managed identity authentication.</span></span> <span data-ttu-id="4ffc2-178">La aplicación debe ejecutarse en un recurso de Azure configurado para usar identidades administradas.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-178">The application must be running on an Azure resource configured to use managed identities.</span></span> <span data-ttu-id="4ffc2-179">Para más información, consulte [Identidades administradas para recursos de Azure].</span><span class="sxs-lookup"><span data-stu-id="4ffc2-179">For details, see [Managed identities for Azure resources].</span></span> |

<span data-ttu-id="4ffc2-180">Si necesita conectarse a un punto de conexión de nube o de administración distinto de la nube pública Azure predeterminada, establezca las siguientes variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-180">To connect to a cloud or management endpoint other than the default Azure public cloud, set the following environment variables.</span></span> <span data-ttu-id="4ffc2-181">Las razones más comunes para establecerlas son si se usa Azure Stack, una nube en una región geográfica diferente o el modelo de implementación clásico de Azure.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-181">The most common reasons are if you use Azure Stack, a cloud in a different geographic region, or the classic deployment model.</span></span>

| <span data-ttu-id="4ffc2-182">Variable de entorno</span><span class="sxs-lookup"><span data-stu-id="4ffc2-182">Environment variable</span></span> | <span data-ttu-id="4ffc2-183">DESCRIPCIÓN</span><span class="sxs-lookup"><span data-stu-id="4ffc2-183">Description</span></span>  |
|----------------------|--------------|
| `AZURE_ENVIRONMENT` | <span data-ttu-id="4ffc2-184">El nombre del entorno de nube al que se conectará.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-184">The name of the cloud environment to connect to.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="4ffc2-185">El identificador de recurso de Active Directory que se usará al conectarse, como el URI de un punto de conexión de administración.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-185">The Active Directory resource ID to use when connecting, as a URI to your management endpoint.</span></span> |

<span data-ttu-id="4ffc2-186">Cuando se usa la autenticación basada en entornos, llame a la función [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) para obtener el objeto autorizador.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-186">When using environment-based authentication, call the [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) function to get your authorizer object.</span></span> <span data-ttu-id="4ffc2-187">Este objeto se establece entonces en la propiedad `Authorizer` de los clientes para permitirles el acceso a Azure.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-187">This object is then set on the `Authorizer` property of clients to allow them access to Azure.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := auth.NewAuthorizerFromEnvironment()
```

### <a name="authentication-on-azure-stack"></a><span data-ttu-id="4ffc2-188">Autenticación en Azure Stack</span><span class="sxs-lookup"><span data-stu-id="4ffc2-188">Authentication on Azure Stack</span></span>

<span data-ttu-id="4ffc2-189">Para autenticarse en Azure Stack, debe establecer las siguientes variables:</span><span class="sxs-lookup"><span data-stu-id="4ffc2-189">To authenticate on Azure Stack, you need to set the following variables:</span></span>

| <span data-ttu-id="4ffc2-190">Variable de entorno</span><span class="sxs-lookup"><span data-stu-id="4ffc2-190">Environment variable</span></span> | <span data-ttu-id="4ffc2-191">DESCRIPCIÓN</span><span class="sxs-lookup"><span data-stu-id="4ffc2-191">Description</span></span>  |
|----------------------|--------------|
| `AZURE_AD_ENDPOINT` | <span data-ttu-id="4ffc2-192">El punto de conexión de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-192">The Active Directory endpoint.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="4ffc2-193">El identificador de recurso de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-193">The Active Directory resource ID.</span></span> |

<span data-ttu-id="4ffc2-194">Estas variables se pueden recuperar de la información de metadatos de Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-194">These variables can be retrieved from Azure Stack metadata information.</span></span> <span data-ttu-id="4ffc2-195">Para recuperar los metadatos, abra un explorador web en su entorno de Azure Stack y use la dirección URL: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span><span class="sxs-lookup"><span data-stu-id="4ffc2-195">To retrieve the metadata, open a web browser in your Azure Stack environment and use the url: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span></span>

<span data-ttu-id="4ffc2-196">El valor de `ResourceManagerURL` varía según el nombre de la región, el nombre de la máquina y el nombre de dominio completo (FQDN) externo de su implementación de Azure Stack:</span><span class="sxs-lookup"><span data-stu-id="4ffc2-196">The `ResourceManagerURL` varies based on the region name, machine name, and external fully qualified domain name (FQDN) of your Azure Stack deployment:</span></span>

| <span data-ttu-id="4ffc2-197">Entorno</span><span class="sxs-lookup"><span data-stu-id="4ffc2-197">Environment</span></span> | <span data-ttu-id="4ffc2-198">ResourceManagerURL</span><span class="sxs-lookup"><span data-stu-id="4ffc2-198">ResourceManagerURL</span></span> |
|----------------------|--------------|
| <span data-ttu-id="4ffc2-199">Kit de desarrollo</span><span class="sxs-lookup"><span data-stu-id="4ffc2-199">Development Kit</span></span> | `https://management.local.azurestack.external/` |
| <span data-ttu-id="4ffc2-200">Sistemas integrados</span><span class="sxs-lookup"><span data-stu-id="4ffc2-200">Integrated Systems</span></span> | `https://management.(region).ext-(machine-name).(FQDN)` |

<span data-ttu-id="4ffc2-201">Para más información sobre cómo usar Azure SDK para Go en Azure Stack, consulte [Uso de perfiles de versión de la API con Go en Azure Stack](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-version-profiles-go).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-201">For more information on how to use the Azure SDK for Go on Azure Stack, see [Use API version profiles with Go in Azure Stack](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-version-profiles-go)</span></span>

## <a name="use-file-based-authentication"></a><span data-ttu-id="4ffc2-202">Uso de la autenticación basada en archivos</span><span class="sxs-lookup"><span data-stu-id="4ffc2-202">Use file-based authentication</span></span>

<span data-ttu-id="4ffc2-203">La autenticación basada en archivos usa un formato de archivo generado por [la CLI de Azure](/cli/azure).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-203">File-based authentication uses a file format generated by [the Azure CLI](/cli/azure).</span></span> <span data-ttu-id="4ffc2-204">Puede crear fácilmente este archivo cuando se crea una nueva entidad de servicio con el parámetro `--sdk-auth`.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-204">You can easily create this file when creating a new service principal with the `--sdk-auth` parameter.</span></span> <span data-ttu-id="4ffc2-205">Si planea utilizar la autenticación basada en archivos, asegúrese de que se proporciona este argumento al crear una entidad de servicio.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-205">If you plan on using file-based authentication, make sure that this argument is provided when creating a service principal.</span></span> <span data-ttu-id="4ffc2-206">Como la CLI imprime la salida en `stdout`, redirija la salida a un archivo.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-206">Since the CLI prints output to `stdout`, redirect output to a file.</span></span>

```azurecli
az ad sp create-for-rbac --sdk-auth > azure.auth
```

<span data-ttu-id="4ffc2-207">Establezca la variable de entorno `AZURE_AUTH_LOCATION` en donde se encuentra el archivo de autorización.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-207">Set the `AZURE_AUTH_LOCATION` environment variable to where the authorization file is located.</span></span> <span data-ttu-id="4ffc2-208">La aplicación lee esta variable de entorno y analiza las credenciales que contiene.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-208">This environment variable is read by the application, and the credentials within it are parsed.</span></span> <span data-ttu-id="4ffc2-209">Si tiene que seleccionar el archivo de autorización en tiempo de ejecución, manipule el entorno del programa mediante la función [os.Setenv](https://golang.org/pkg/os/#Setenv).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-209">If you need to select the authorization file at runtime, manipulate the program's environment using the [os.Setenv](https://golang.org/pkg/os/#Setenv) function.</span></span>

<span data-ttu-id="4ffc2-210">Para cargar la información de autenticación, llame a la función [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-210">To load the authentication information, call the [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile) function.</span></span> <span data-ttu-id="4ffc2-211">A diferencia de la autorización basada en entornos, la autorización basada en archivos requiere un punto de conexión de recursos.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-211">Unlike environment-based authorization, file-based authorization requires a resource endpoint.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := NewAuthorizerFromFile(azure.PublicCloud.ResourceManagerEndpoint)
```

<span data-ttu-id="4ffc2-212">Para más información acerca del uso de entidades de servicio y la administración de los permisos de acceso, consulte [Creación de una entidad de servicio con la CLI de Azure].</span><span class="sxs-lookup"><span data-stu-id="4ffc2-212">For more on using service principals and managing their access permissions, see [Create a service principal with Azure CLI].</span></span>

## <a name="use-device-token-authentication"></a><span data-ttu-id="4ffc2-213">Uso de la autenticación por tokens del dispositivo</span><span class="sxs-lookup"><span data-stu-id="4ffc2-213">Use device token authentication</span></span>

<span data-ttu-id="4ffc2-214">Si desea que los usuarios inicien sesión de forma interactiva, la mejor manera es mediante la autenticación por token de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-214">If you want users to sign in interactively, the best way is through device token authentication.</span></span> <span data-ttu-id="4ffc2-215">Este flujo de autenticación pasa al usuario un token para pegarlo en un sitio de inicio de sesión de Microsoft, donde luego se autentica con una cuenta de Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-215">This authentication flow passes the user a token to paste into a Microsoft sign-in site, where they then authenticate with an Azure Active Directory (AAD) account.</span></span> <span data-ttu-id="4ffc2-216">Este método de autenticación admite cuentas que tienen habilitada la autenticación multifactor, a diferencia de la autenticación estándar de nombre de usuario y contraseña.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-216">This authentication method supports accounts that have multi-factor authentication enabled, unlike standard username/password authentication.</span></span>

<span data-ttu-id="4ffc2-217">Para usar la autenticación por tokens del dispositivo, cree un autorizador de [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) con la función [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-217">To use device token authentication, create a [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) authorizer with the [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig) function.</span></span> <span data-ttu-id="4ffc2-218">Llame al [autorizador](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) en el objeto resultante para iniciar el proceso de autenticación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-218">Call [Authorizer](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) on the resulting object to start the authentication process.</span></span> <span data-ttu-id="4ffc2-219">La autenticación por flujo de dispositivo bloquea la ejecución del programa hasta que se complete todo el flujo de autenticación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-219">Device flow authentication blocks program execution until the whole authentication flow is complete.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
deviceConfig := auth.NewDeviceFlowConfig(applicationID, tenantID)
authorizer, err := deviceConfig.Authorizer()
```

## <a name="use-an-authentication-client"></a><span data-ttu-id="4ffc2-220">Uso de un cliente de autenticación</span><span class="sxs-lookup"><span data-stu-id="4ffc2-220">Use an authentication client</span></span>

<span data-ttu-id="4ffc2-221">Si necesita un tipo específico de autenticación y está dispuesto a que el programa haga el trabajo de cargar la información de autenticación del usuario, puede utilizar cualquier cliente que se ajuste a la interfaz [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig).</span><span class="sxs-lookup"><span data-stu-id="4ffc2-221">If you require a specific type of authentication and are willing to have your program do the work to load authentication information from the user, you can use any client that conforms to the [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig) interface.</span></span> <span data-ttu-id="4ffc2-222">Use un tipo que implementa esta interfaz si:</span><span class="sxs-lookup"><span data-stu-id="4ffc2-222">Use a type that implements this interface when you:</span></span>

* <span data-ttu-id="4ffc2-223">Está escribiendo un programa interactivo</span><span class="sxs-lookup"><span data-stu-id="4ffc2-223">Write an interactive program</span></span>
* <span data-ttu-id="4ffc2-224">Usa archivos de configuración especializados</span><span class="sxs-lookup"><span data-stu-id="4ffc2-224">Use specialized configuration files</span></span>
* <span data-ttu-id="4ffc2-225">Tiene un requisito que impide el uso de un método de autenticación integrado</span><span class="sxs-lookup"><span data-stu-id="4ffc2-225">Have a requirement that prevents using a built-in authentication method</span></span>

> [!WARNING]
> <span data-ttu-id="4ffc2-226">Nunca codifique de forma rígida las credenciales de Azure en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-226">Never hard-code Azure credentials into an application.</span></span> <span data-ttu-id="4ffc2-227">Poner secretos en un archivo binario de una aplicación hace más fácil su extracción por parte de un atacante, ya se esté ejecutando la aplicación o no.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-227">Putting secrets into an application binary makes it easier for an attacker to extract them, whether the application is running or not.</span></span> <span data-ttu-id="4ffc2-228">Esto pone en riesgo todos los recursos de los Azure cuyas credenciales están autorizadas.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-228">This puts all Azure resources the credentials are authorized for at risk!</span></span>

<span data-ttu-id="4ffc2-229">En la tabla siguiente se enumeran los tipos en el SDK que se ajustan a la interfaz `AuthorizerConfig`.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-229">The following table lists the types in the SDK that conform to the `AuthorizerConfig` interface.</span></span>

| <span data-ttu-id="4ffc2-230">Tipo de autenticación</span><span class="sxs-lookup"><span data-stu-id="4ffc2-230">Authentication type</span></span> | <span data-ttu-id="4ffc2-231">Tipo de autorizador</span><span class="sxs-lookup"><span data-stu-id="4ffc2-231">Authorizer type</span></span> |
|---------------------|-----------------------|
| <span data-ttu-id="4ffc2-232">Autenticación basada en certificados</span><span class="sxs-lookup"><span data-stu-id="4ffc2-232">Certificate-based authentication</span></span> | <span data-ttu-id="4ffc2-233">[ClientCertificateConfig]</span><span class="sxs-lookup"><span data-stu-id="4ffc2-233">[ClientCertificateConfig]</span></span> |
| <span data-ttu-id="4ffc2-234">Credenciales de cliente</span><span class="sxs-lookup"><span data-stu-id="4ffc2-234">Client credentials</span></span> | <span data-ttu-id="4ffc2-235">[ClientCredentialsConfig]</span><span class="sxs-lookup"><span data-stu-id="4ffc2-235">[ClientCredentialsConfig]</span></span> |
| <span data-ttu-id="4ffc2-236">Identidades administradas de recursos de Azure</span><span class="sxs-lookup"><span data-stu-id="4ffc2-236">Managed identities for Azure resources</span></span> | <span data-ttu-id="4ffc2-237">[MSIConfig]</span><span class="sxs-lookup"><span data-stu-id="4ffc2-237">[MSIConfig]</span></span> |
| <span data-ttu-id="4ffc2-238">Nombre de usuario/contraseña</span><span class="sxs-lookup"><span data-stu-id="4ffc2-238">Username/password</span></span> | <span data-ttu-id="4ffc2-239">[UsernamePasswordConfig]</span><span class="sxs-lookup"><span data-stu-id="4ffc2-239">[UsernamePasswordConfig]</span></span> |

[ClientCertificateConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCertificateConfig
[ClientCredentialsConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCredentialsConfig
[MSIConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#MSIConfig
[DeviceFlowConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig
[UsernamePasswordConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#UsernamePasswordConfig

<span data-ttu-id="4ffc2-244">Cree un autenticador con su función `New` asociada y, después, llame a `Authorize` en el objeto resultante para realizar la autenticación.</span><span class="sxs-lookup"><span data-stu-id="4ffc2-244">Create an authenticator with its associated `New` function, and then call `Authorize` on the resulting object to authenticate.</span></span> <span data-ttu-id="4ffc2-245">Por ejemplo, para usar la autenticación basada en certificado:</span><span class="sxs-lookup"><span data-stu-id="4ffc2-245">For example, to use certificate-based authentication:</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
certificateAuthorizer := auth.NewClientCertificateConfig(certificatePath, certificatePassword, clientID, tenantID)
authorizerToken, err := certificateAuthorizer.Authorize()
```
